import{_ as q,a as Q}from"./Modal.b73f5a06.js";import{_ as U}from"./Datatable.vue.ca3ea79b.js";import{_ as O}from"./Spinner.d3bd0c23.js";import{J as P,r as y,n as D,o as _,c as m,b as $,w as k,a as e,u as o,q as A,y as x,K as B,F as j,s as F,t as v,z as C,d as h,x as T,B as S,g as z,A as I}from"./entry.8274f21e.js";import{F as J}from"./FirestoreService.ba9c0b5d.js";import{u as N}from"./productsStore.73f71b64.js";import{u as K}from"./spendsStore.b3cd664d.js";const M=P("loss",()=>{const g=y([]),n=y([]),d=y(!1),b=new J,c="losses",s=()=>g.value.length,l=async()=>{d.value=!0,await b.getListFromCollection(c).then(u=>{g.value=u,d.value=!1})},f=async u=>{const t=await b.create(c,u);return await l(),t},a=async(u,t)=>{const p=await b.update(c,t,u);return await l(),p},r=async u=>{console.log("===============id====================="),console.log(u),console.log("===================================="),await b.delete(c,u),await l()};return l(),{losses:g,loading:d,errors:n,lossesCount:s,getData:l,postData:f,updateData:a,deleteData:r}}),R={class:"modal-content text-left"},G={class:"flex p-4 bg-blue-400 text-white justify-between pb-3"},H=e("h3",{class:"text-xl"},[e("i",{class:"fa-solid fa-circle-plus"}),h(" Ajouter une perte ")],-1),W=e("i",{class:"fa-solid fa-xmark"},null,-1),X=[W],Y={key:0,class:"flex bg-white h-64 w-full justify-center items-center"},Z={key:1},ee=["onSubmit"],te={style:{height:"70vh"},class:"modal-body pb-16 p-5 overflow-y-auto"},se={class:"mb-4"},oe=e("label",{for:"product",class:"block text-gray-700 font-bold mb-2"},"Nom du produit perdu: ",-1),ne=e("option",{value:"",disabled:"",selected:""}," Sélectionnez une option ",-1),le=["value"],ae={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ie={class:"mb-4"},de=e("label",{class:"block text-gray-700 text-sm font-bold mb-2",for:"quantity"},"Quantité:",-1),re={class:"mb-4"},ce=e("label",{class:"block text-gray-700 text-sm font-bold mb-2",for:"slug"},"Description :",-1),ue={class:"absolute bg-gray-100 w-full flex justify-end bottom-0 p-4"},pe=e("i",{class:"fa-solid fa-close"},null,-1),_e=e("button",{type:"submit",class:"btn-primary text-white py-2 px-4 rounded-sm"},[e("i",{class:"fa-solid fa-save"}),h(" Enregistrer ")],-1),fe=D({__name:"AddLossModal",props:{isOpen:{type:Boolean,required:!0,default:!1}},emits:["onClose","onSuccess"],setup(g,{emit:n}){const d=M(),b=N(),c=y(!1),s=y({product:null,quantity:null,description:""}),l=async()=>{c.value=!0,await d.postData(s.value).then(f=>{f&&(n("onClose"),n("onSuccess","Dépense ajoutée avec succès"),s.value.product=null,s.value.quantity=null,s.value.description=""),c.value=!1}),setTimeout(()=>{c.value=!1},15e3)};return(f,a)=>{const r=O,u=q;return _(),m("div",null,[$(u,{"is-open":g.isOpen},{default:k(()=>[e("div",R,[e("div",G,[H,e("button",{onClick:a[0]||(a[0]=t=>f.$emit("onClose")),class:"modal-close"},X)]),o(c)?(_(),m("div",Y,[$(r,{class:"h-12"})])):(_(),m("div",Z,[e("form",{onSubmit:A(l,["prevent"])},[e("div",te,[e("div",se,[oe,x(e("select",{"onUpdate:modelValue":a[1]||(a[1]=t=>o(s).product=t),name:"product",id:"product",class:"bg-transparent border rounded w-full text-gray-700 py-2 pl-3 pr-10 focus:outline-none focus:border-blue-500",required:""},[ne,(_(!0),m(j,null,F(o(b).products,(t,p)=>(_(),m("option",{key:p,value:t},v(t.name+"(Prix d'achat: "+t.purchase_price+")"),9,le))),128))],512),[[B,o(s).product]])]),e("div",ae,[e("div",ie,[de,x(e("input",{"onUpdate:modelValue":a[2]||(a[2]=t=>o(s).quantity=t),class:"border rounded-md py-2 px-3 w-full",type:"text",id:"quantity",name:"quantity",placeholder:"Quantité",required:""},null,512),[[C,o(s).quantity]])])]),e("div",re,[ce,x(e("textarea",{"onUpdate:modelValue":a[3]||(a[3]=t=>o(s).description=t),id:"description",name:"description",class:"w-full border rounded py-2 px-3 text-gray-700 focus:outline-none focus:border-blue-500",required:"",placeholder:"Description"},null,512),[[C,o(s).description]])])]),e("div",ue,[e("a",{class:"bg-gray-200 text-black py-2 px-4 rounded-sm mr-2",onClick:a[4]||(a[4]=t=>f.$emit("onClose"))},[pe,h(" Fermer ")]),_e])],40,ee)]))])]),_:1},8,["is-open"])])}}}),me={class:"modal-content text-left"},he={class:"flex p-4 bg-yellow-500 text-white justify-between pb-3"},be=e("h3",{class:"text-xl"},[e("i",{class:"fa-regular fa-eye"}),h(" Voir une perte")],-1),ye=e("i",{class:"fa-solid fa-xmark"},null,-1),ve=[ye],$e={style:{height:"80vh"},class:"modal-body pb-16 p-5 overflow-y-auto"},ge=e("strong",null,"ID:",-1),xe=e("strong",null,"Nom du produit:",-1),we=e("strong",null,"Quantité:",-1),De={key:0},ke=e("strong",null,"Montant total de la perte:",-1),Ce=e("strong",null,"Description:",-1),Se=e("strong",null,"Date de création:",-1),qe=e("strong",null,"Date de modification:",-1),Oe={class:"absolute bg-gray-100 w-full flex justify-end bottom-0 p-4"},je=e("i",{class:"fa-solid fa-close"},null,-1),Fe=D({__name:"ViewLossModal",props:{isOpen:{type:Boolean},selectedData:{}},setup(g){return(n,d)=>{const b=q;return _(),m("div",null,[$(b,{"is-open":n.isOpen},{default:k(()=>{var c,s,l,f,a,r,u,t,p;return[e("div",me,[e("div",he,[be,e("button",{onClick:d[0]||(d[0]=w=>n.$emit("onClose")),class:"modal-close"},ve)]),e("div",$e,[e("li",null,[ge,h(" "+v((c=n.selectedData)==null?void 0:c.id),1)]),e("li",null,[xe,h(" "+v((l=(s=n.selectedData)==null?void 0:s.product)==null?void 0:l.name),1)]),e("li",null,[we,h(" "+v((f=n.selectedData)==null?void 0:f.quantity),1)]),n.selectedData?(_(),m("li",De,[ke,h(" "+v(((a=n.selectedData)==null?void 0:a.product.purchase_price)*((r=n.selectedData)==null?void 0:r.quantity)),1)])):T("",!0),e("li",null,[Ce,h(" "+v((u=n.selectedData)==null?void 0:u.description),1)]),e("li",null,[Se,h(" "+v(("formatDateFrench"in n?n.formatDateFrench:o(S))((t=n.selectedData)==null?void 0:t.createdAt)),1)]),e("li",null,[qe,h(" "+v(("formatDateFrench"in n?n.formatDateFrench:o(S))((p=n.selectedData)==null?void 0:p.updatedAt)),1)])]),e("div",Oe,[e("button",{class:"bg-gray-200 text-black py-1 px-4 rounded-sm mr-2",onClick:d[1]||(d[1]=w=>n.$emit("onClose"))},[je,h(" Fermer ")])])])]}),_:1},8,["is-open"])])}}}),Me={class:"modal-content text-left"},Ve={class:"flex p-4 bg-blue-400 text-white justify-between pb-3"},Ae=e("h3",{class:"text-xl"},[e("i",{class:"fa-solid fa-circle-plus"}),h(" Editer une perte ")],-1),Be=e("i",{class:"fa-solid fa-xmark"},null,-1),Ne=[Be],Le={key:0,class:"flex bg-white h-64 w-full justify-center items-center"},Ee={key:1},Qe=["onSubmit"],Ue={style:{height:"60vh"},class:"modal-body pb-16 p-5 overflow-y-auto"},Pe={class:"mb-4"},Te=e("label",{for:"product",class:"block text-gray-700 font-bold mb-2"},"Nom du produit perdu: ",-1),ze=e("option",{value:"",disabled:"",selected:""}," Sélectionnez une option ",-1),Ie=["value"],Je={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Ke={class:"mb-4"},Re=e("label",{class:"block text-gray-700 text-sm font-bold mb-2",for:"quantity"},"Quantité:",-1),Ge={class:"mb-4"},He=e("label",{class:"block text-gray-700 text-sm font-bold mb-2",for:"slug"},"Description :",-1),We={class:"absolute bg-gray-100 w-full flex justify-end bottom-0 p-4"},Xe=e("i",{class:"fa-solid fa-close"},null,-1),Ye=e("button",{type:"submit",class:"btn-primary text-white py-2 px-4 rounded-sm"},[e("i",{class:"fa-solid fa-save"}),h(" Enregistrer ")],-1),Ze=D({__name:"EditLossModal",props:{isOpen:{type:Boolean},selectedData:{}},emits:["onClose","onSuccess"],setup(g,{emit:n}){const d=g,b=M(),c=N(),s=y(!1),l=y({product:null,quantity:null,description:""});z(()=>d.isOpen,()=>{d.selectedData&&(l.value={...d.selectedData})});const f=async()=>{s.value=!0,d.selectedData&&await b.updateData(l.value,d.selectedData.id).then(a=>{a&&(console.log("=============status======================="),console.log(a),console.log("===================================="),n("onClose"),n("onSuccess","Dépense mise à jour avec succès")),s.value=!1}),setTimeout(()=>{s.value=!1},15e3)};return(a,r)=>{const u=O,t=q;return _(),m("div",null,[$(t,{"is-open":a.isOpen},{default:k(()=>[e("div",Me,[e("div",Ve,[Ae,e("button",{onClick:r[0]||(r[0]=p=>a.$emit("onClose")),class:"modal-close"},Ne)]),o(s)?(_(),m("div",Le,[$(u,{class:"h-12"})])):(_(),m("div",Ee,[e("form",{onSubmit:A(f,["prevent"])},[e("div",Ue,[e("div",Pe,[Te,x(e("select",{"onUpdate:modelValue":r[1]||(r[1]=p=>o(l).product=p),name:"product",id:"product",class:"bg-transparent border rounded w-full text-gray-700 py-2 pl-3 pr-10 focus:outline-none focus:border-blue-500",required:""},[ze,(_(!0),m(j,null,F(o(c).products,(p,w)=>(_(),m("option",{key:w,value:p},v(p.name+"(Prix d'achat: "+p.purchase_price+")"),9,Ie))),128))],512),[[B,o(l).product]])]),e("div",Je,[e("div",Ke,[Re,x(e("input",{"onUpdate:modelValue":r[2]||(r[2]=p=>o(l).quantity=p),class:"border rounded-md py-2 px-3 w-full",type:"text",id:"quantity",name:"quantity",placeholder:"Quantité",required:""},null,512),[[C,o(l).quantity]])])]),e("div",Ge,[He,x(e("textarea",{"onUpdate:modelValue":r[3]||(r[3]=p=>o(l).description=p),id:"description",name:"description",class:"w-full border rounded py-2 px-3 text-gray-700 focus:outline-none focus:border-blue-500",required:"",placeholder:"Description"},null,512),[[C,o(l).description]])])]),e("div",We,[e("a",{class:"bg-gray-200 text-black py-2 px-4 rounded-sm mr-2",onClick:r[4]||(r[4]=p=>a.$emit("onClose"))},[Xe,h(" Fermer ")]),Ye])],40,Qe)]))])]),_:1},8,["is-open"])])}}}),et={class:"modal-content text-left h-56"},tt={class:"flex p-4 bg-red-500 text-white justify-between pb-3"},st=e("h3",{class:"text-xl"},"Confirmer la suppression",-1),ot=e("i",{class:"fa-solid fa-xmark"},null,-1),nt=[ot],lt={key:0,class:"flex bg-white h-full w-full justify-center items-center"},at={key:1},it={class:"modal-body p-5"},dt={class:"absolute bg-gray-100 w-full flex justify-end bottom-0 p-4"},rt=e("i",{class:"fa-solid fa-close"},null,-1),ct=e("i",{class:"fa-solid fa-trash"},null,-1),ut=D({__name:"DeleteLossModal",props:{isOpen:{type:Boolean},selectedData:{}},emits:["onClose","onSuccess"],setup(g,{emit:n}){const d=y(!1),b=K(),c=async s=>{d.value=!0,b.deleteData(s).then(()=>{d.value=!1,n("onClose"),n("onSuccess","Dépense supprimée avec succès")})};return(s,l)=>{const f=O,a=q;return _(),m("div",null,[$(a,{"is-open":s.isOpen},{default:k(()=>{var r;return[e("div",et,[e("div",tt,[st,e("button",{onClick:l[0]||(l[0]=u=>s.$emit("onClose")),class:"modal-close"},nt)]),o(d)?(_(),m("div",lt,[$(f,{class:"h-12"})])):(_(),m("div",at,[e("div",it,[e("p",null,v(`Supprimer la perte de ${(r=s.selectedData)==null?void 0:r.product.name} ?`),1)]),e("div",dt,[e("button",{class:"bg-gray-200 text-black py-1 px-4 rounded-sm mr-2",onClick:l[1]||(l[1]=u=>s.$emit("onClose"))},[rt,h(" Fermer ")]),e("button",{onClick:l[2]||(l[2]=u=>{var t;return c(((t=s.selectedData)==null?void 0:t.id)??"")}),class:"btn-primary text-white py-1 px-4 rounded-sm"},[ct,h(" Supprimer ")])])]))])]}),_:1},8,["is-open"])])}}}),pt=e("i",{class:"fa-solid fa-circle-plus"},null,-1),_t={class:"p-5 bg-white w-full h-full shadow-2xl rounded-lg bg-opacity-25"},ft=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-sm font-bold"},"Produit perdu"),e("th",{class:"px-6 py-3 text-left text-sm font-bold"},"Prix unitaire"),e("th",{class:"px-6 py-3 text-left text-sm font-bold"},"Quantité"),e("th",{class:"px-6 py-3 text-left text-sm font-bold"},"Montant total"),e("th",{class:"px-6 py-3 text-left text-sm font-bold"},"Description"),e("th",{class:"px-6 py-3 text-left text-sm font-bold"},"Actions")])],-1),mt={class:"bg-white text-gray-600 divide-y divide-gray-200"},ht=["title"],bt={class:"px-6 py-4 whitespace-no-wrap"},yt={class:"px-6 py-4 whitespace-no-wrap"},vt={class:"px-6 py-4 whitespace-no-wrap"},$t={class:"px-6 py-4 whitespace-no-wrap"},gt={class:"px-6 py-4 whitespace-no-wrap"},xt={class:"flex gap-2"},wt=["onClick"],Dt=e("i",{class:"fa-regular fa-eye"},null,-1),kt=[Dt],Ct=["onClick"],St=e("i",{class:"fa-regular fa-pen-to-square"},null,-1),qt=[St],Ot=["onClick"],jt=e("i",{class:"fa-regular fa-trash-can"},null,-1),Ft=[jt],Mt={key:1,class:"flex flex-col justify-center items-center"},Vt=e("p",{class:"m-2"},"Chargement en cours...",-1),Pt=D({__name:"losses",setup(g){const n=M(),d=y(),b=y(!1),c=y(!1),s=y(!1),l=y(!1),f=y(!1),a=y(""),r=(u,t)=>{switch(d.value=u,t){case"read":c.value=!0;break;case"edit":l.value=!0;break;case"delete":s.value=!0;break}console.log("===================================="),console.log(c.value),console.log("====================================")};return(u,t)=>{const p=Q,w=U,L=O;return _(),m("div",null,[$(p,{show:o(f),title:"alertTitle",message:o(a),onOnClose:t[0]||(t[0]=i=>f.value=!1)},null,8,["show","message"]),$(fe,{onOnSuccess:t[1]||(t[1]=i=>{a.value=i,f.value=!0}),onOnClose:t[2]||(t[2]=i=>b.value=!1),"is-open":o(b)},null,8,["is-open"]),$(Fe,{onOnClose:t[3]||(t[3]=i=>c.value=!1),"is-open":o(c),"selected-data":o(d)},null,8,["is-open","selected-data"]),$(Ze,{onOnSuccess:t[4]||(t[4]=i=>{a.value=i,f.value=!0}),onOnClose:t[5]||(t[5]=i=>l.value=!1),"is-open":o(l),"selected-data":o(d)},null,8,["is-open","selected-data"]),$(ut,{onOnSuccess:t[6]||(t[6]=i=>{a.value=i,f.value=!0}),onOnClose:t[7]||(t[7]=i=>s.value=!1),"is-open":o(s),"selected-data":o(d)},null,8,["is-open","selected-data"]),e("button",{onClick:t[8]||(t[8]=i=>b.value=!0),class:"py-2 p-4 shadow-xl btn-primary my-4 text-white"},[pt,h(" Ajouter nouveau ")]),e("div",_t,[o(n).loading?(_(),m("div",Mt,[Vt,$(L,{class:"h-12"})])):(_(),I(w,{key:0},{default:k(()=>[ft,e("tbody",mt,[(_(!0),m(j,null,F(o(n).losses,(i,E)=>(_(),m("tr",{key:E,title:`Créé le ${o(S)(i.createdAt)}
Modifié le ${o(S)(i.updatedAt)}}`},[e("td",bt,v(i.product.name),1),e("td",yt,v(i==null?void 0:i.product.purchase_price),1),e("td",vt,v(i.quantity),1),e("td",$t,v((i==null?void 0:i.product.purchase_price)*(i==null?void 0:i.quantity)),1),e("td",gt,v(i.description),1),e("td",xt,[e("a",{class:"p-0.5 px-2 text-white bg-yellow-500 hover:bg-yellow-600 shadow-xl rounded-sm",onClick:V=>r(i,"read")},kt,8,wt),e("a",{class:"p-0.5 px-2 text-white bg-blue-500 hover:bg-blue-600 shadow-xl rounded-sm",onClick:V=>r(i,"edit")},qt,8,Ct),e("a",{class:"p-0.5 px-2 text-white bg-red-500 hover:bg-red-600 shadow-xl rounded-sm",onClick:V=>r(i,"delete")},Ft,8,Ot)])],8,ht))),128))])]),_:1}))])])}}});export{Pt as default};
